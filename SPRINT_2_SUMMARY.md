# üìÑ Sprint 2 Summary ‚Äî PDF Import

**–ü—Ä–æ–µ–∫—Ç:** Smart Warehouse AI
**–°–ø—Ä–∏–Ω—Ç:** 2 –∏–∑ 10
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 2-3 –Ω–µ–¥–µ–ª–∏ (–ø–ª–∞–Ω)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ó–ê–í–ï–†–®–Å–ù**
**–î–∞—Ç–∞:** 05.10.2025

---

## üéØ –¶–µ–ª–∏ —Å–ø—Ä–∏–Ω—Ç–∞

‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–º–ø–æ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –∏–∑ PDF
‚úÖ –°–æ–∑–¥–∞—Ç—å –ø–∞—Ä—Å–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (—Ç–∞–±–ª–∏—Ü—ã + OCR)
‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Strategy Pattern –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–∞—Ä—Å–µ—Ä–∞
‚úÖ –°–æ–∑–¥–∞—Ç—å UI –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ ItemService

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã (`PDFParserTypes.swift`)

#### **ParsedItem** ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
```swift
struct ParsedItem {
    var name: String
    var sku: String?
    var category: String?
    var description: String?
    var barcode: String?
    var confidence: Double = 1.0  // 0.0 - 1.0
    var pageNumber: Int?

    func toItem() -> Item
}
```

#### **PDFParseResult** ‚Äî –∏—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞
```swift
struct PDFParseResult {
    let items: [ParsedItem]
    let totalPages: Int
    let parseMethod: String
    let warnings: [String]
    let errors: [String]
    var successRate: Double
}
```

#### **PDFParserStrategy Protocol**
```swift
protocol PDFParserStrategy {
    var name: String { get }
    func canParse(_ document: PDFDocument) -> Bool
    func parse(_ document: PDFDocument) async throws -> PDFParseResult
}
```

#### **PDFParserConfig** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞
- `minimumConfidence: Double` ‚Äî –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (default: 0.5)
- `enableOCR: Bool` ‚Äî –≤–∫–ª—é—á–∏—Ç—å OCR (default: true)
- `maxPages: Int` ‚Äî –ª–∏–º–∏—Ç —Å—Ç—Ä–∞–Ω–∏—Ü (0 = –±–µ–∑ –ª–∏–º–∏—Ç–∞)
- `autoCategories: [String]` ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

#### **PDFParserError** ‚Äî —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- `cannotOpenFile`
- `emptyDocument`
- `noSuitableParser`
- `parsingFailed(String)`
- `invalidFormat(String)`
- `ocrFailed(String)`

---

### 2. TableBasedPDFParser (–¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö PDF)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞—Ä—Å–∏–Ω–≥ PDF —Å –∏–∑–≤–ª–µ–∫–∞–µ–º—ã–º —Ç–µ–∫—Å—Ç–æ–º (—Ç–∞–±–ª–∏—Ü—ã, —Å–ø–∏—Å–∫–∏)

#### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏** (`canParse`):
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ PDF
   - –ò—â–µ—Ç —Ç–∞–±—É–ª—è—Ü–∏–∏, –ø—Ä–æ–±–µ–ª—ã, —Ü–∏—Ñ—Ä—ã

2. **–ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü**:
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ `PDFPage.string`
   - –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ —Å—Ç—Ä–æ–∫–∏

3. **–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫** (3 –º–µ—Ç–æ–¥–∞):

   **a) Tab-Delimited Format**
   ```
   BOLT-M6\t–ë–æ–ª—Ç –ú6x20\t–ö—Ä–µ–ø—ë–∂–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
   ```
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ `\t`
   - Confidence: 0.9

   **b) Space-Delimited with Pattern**
   ```
   CODE-123 Item Name (optional description)
   ```
   - Regex: `^([A-Z0-9\-]+)\s+(.+?)(?:\s*\((.+?)\))?$`
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ SKU, name, description
   - Confidence: 0.8

   **c) Key-Value Format**
   ```
   Name: –ë–æ–ª—Ç –ú6x20
   ```
   - –ü–∞—Ä—Å–∏–Ω–≥ "–∫–ª—é—á: –∑–Ω–∞—á–µ–Ω–∏–µ"
   - –§–∏–ª—å—Ç—Ä –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (name, item, product, part)
   - Confidence: 0.6

4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**:
   - –ü–æ `minimumConfidence`
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∞—Å—Å–∏–≤ `ParsedItem` —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö PDF

---

### 3. OCRBasedPDFParser (–¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö PDF)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–∞—Ä—Å–∏–Ω–≥ —Å–∫–∞–Ω–æ–≤ —á–µ—Ä–µ–∑ Vision Framework OCR

#### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏** (`canParse`):
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ `enableOCR = true`
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ —Ç–µ–∫—Å—Ç–∞ < 100 —Å–∏–º–≤–æ–ª–æ–≤ (–≤–µ—Ä–æ—è—Ç–Ω–æ —Å–∫–∞–Ω)

2. **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ PDF –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**:
   ```swift
   let image = renderPageToImage(page)  // Scale: 2.0 –¥–ª—è –ª—É—á—à–µ–≥–æ OCR
   ```

3. **OCR —á–µ—Ä–µ–∑ Vision**:
   ```swift
   let request = VNRecognizeTextRequest()
   request.recognitionLevel = .accurate
   request.recognitionLanguages = ["en", "ru"]
   request.usesLanguageCorrection = true
   ```

4. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞**:
   - –ü–æ–ª—É—á–µ–Ω–∏–µ `VNRecognizedTextObservation`
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ (—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑)
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ + confidence

5. **–ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞**:
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (page, catalog, price, list)
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ SKU —á–µ—Ä–µ–∑ regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
     - `[A-Z]{2,}[\-0-9A-Z]+` (BOLT-M6-20)
     - `[A-Z]\d{3,}` (A1234)
     - `\d{4,}` (123456)
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ description –≤ —Å–∫–æ–±–∫–∞—Ö
   - Confidence OCR √ó 0.8 (—Å–Ω–∏–∂–µ–Ω–∏–µ –∏–∑-–∑–∞ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∞—Å—Å–∏–≤ `ParsedItem` –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

**‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –¢—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã (–¥–ª—è Vision Framework)
- –ö–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∫–∞–Ω–∞
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ —á–µ–º table-based –ø–∞—Ä—Å–∏–Ω–≥

---

### 4. PDFImportService (–≥–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å)

#### **PDFParserFactory**
```swift
static func selectParser(for document: PDFDocument) -> PDFParserStrategy
```
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: TableBased ‚Üí OCR ‚Üí TableBased (fallback)

#### **PDFImportService API**

**a) importCatalog(from: URL) ‚Üí ImportResult**
- –ó–∞–≥—Ä—É–∑–∫–∞ PDF
- –í—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞
- –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**b) saveItems(_ parsedItems: [ParsedItem]) ‚Üí SaveResult**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ SKU
- –°–æ–∑–¥–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `ItemService`
- –ü–æ–¥—Å—á—ë—Ç imported/skipped
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**c) importAndSave(from: URL) ‚Üí CompleteImportResult**
- –ü–æ–ª–Ω—ã–π workflow: –ø–∞—Ä—Å–∏–Ω–≥ + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

#### Result Types

**ImportResult:**
- `sourceFile: String`
- `parseResult: PDFParseResult`
- `importedItems: [Item]`
- `skippedItems: [(ParsedItem, String)]`

**SaveResult:**
- `imported: [Item]`
- `skipped: [(ParsedItem, String)]`
- `successCount: Int`
- `successRate: Double`

**CompleteImportResult:**
- `sourceFile: String`
- `parseResult: PDFParseResult`
- `saveResult: SaveResult`
- `summary: String` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

---

### 5. PDFImportView (UI)

#### –°–æ—Å—Ç–æ—è–Ω–∏—è —ç–∫—Ä–∞–Ω–∞:

**a) Upload View** (–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- –ò–∫–æ–Ω–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –ö–Ω–æ–ø–∫–∞ "Choose PDF File"
- Info cards:
  - ‚úÖ Supports structured PDFs with tables
  - ‚úÖ OCR for scanned catalogs
  - ‚úÖ Auto-detection of SKU and names
- File picker (`.pdf` only)

**b) Processing View**
- ProgressView
- –°—Ç–∞—Ç—É—Å: "Processing PDF...", "Parsing document..."

**c) Result View**
- **Summary Card:**
  - –ò–∫–æ–Ω–∫–∞ (‚úì success –∏–ª–∏ ‚ö†Ô∏è warning)
  - –ò–º—è —Ñ–∞–π–ª–∞
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: Imported / Skipped / Success %
- **Warnings Section** (–µ—Å–ª–∏ –µ—Å—Ç—å)
- **Errors Section** (–µ—Å–ª–∏ –µ—Å—Ç—å)
- **Skipped Items** —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏
- –ö–Ω–æ–ø–∫–∞ "Done"

#### PDFImportViewModel

```swift
@Published var showingFilePicker: Bool
@Published var isProcessing: Bool
@Published var processingStatus: String?
@Published var importResult: CompleteImportResult?

func handleFileSelection(_ result: Result<[URL], Error>) async
```

**Workflow:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç PDF
2. `startAccessingSecurityScopedResource()` –¥–ª—è sandbox
3. `importService.importAndSave(from: url)`
4. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

---

### 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ ItemsView

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:
```swift
@State private var showingPDFImport = false

.toolbar {
    ToolbarItem(placement: .navigationBarLeading) {
        Button("Import PDF") {
            showingPDFImport = true
        }
    }
}

.sheet(isPresented: $showingPDFImport) {
    PDFImportView()
        .onDisappear {
            loadItems() // Refresh –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞
        }
}
```

**UX Flow:**
1. –ö–Ω–æ–ø–∫–∞ "Import PDF" –≤ Items
2. –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ `PDFImportView`
3. –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ ‚Üí –ü–∞—Ä—Å–∏–Ω–≥ ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç
4. –ó–∞–∫—Ä—ã—Ç–∏–µ ‚Üí –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è)

```
SmartWarehouseAI/Core/Integrations/
‚îú‚îÄ‚îÄ PDFParserTypes.swift           ‚ú® NEW
‚îú‚îÄ‚îÄ TableBasedPDFParser.swift      ‚ú® NEW
‚îú‚îÄ‚îÄ OCRBasedPDFParser.swift        ‚ú® NEW
‚îî‚îÄ‚îÄ PDFImportService.swift         ‚ú® NEW

SmartWarehouseAI/UI/
‚îî‚îÄ‚îÄ PDFImportView.swift            ‚ú® NEW
```

### –î–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤

```
PDFParserStrategy (Protocol)
    ‚îú‚îÄ‚îÄ TableBasedPDFParser
    ‚îî‚îÄ‚îÄ OCRBasedPDFParser

PDFParserFactory
    ‚îî‚îÄ‚îÄ selectParser() ‚Üí PDFParserStrategy

PDFImportService
    ‚îú‚îÄ‚îÄ importCatalog()
    ‚îú‚îÄ‚îÄ saveItems()
    ‚îî‚îÄ‚îÄ importAndSave()

PDFImportView
    ‚îî‚îÄ‚îÄ PDFImportViewModel
        ‚îî‚îÄ‚îÄ handleFileSelection()
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã PDF:

#### ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ PDF:
- –¢–∞–±–ª–∏—Ü—ã —Å tab-—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏
- –°–ø–∏—Å–∫–∏ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
- Key-value —Ñ–æ—Ä–º–∞—Ç—ã
- **–ü—Ä–∏–º–µ—Ä—ã:** Excel ‚Üí PDF, Word ‚Üí PDF, generated catalogs

#### ‚úÖ –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ PDF:
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∫–∞—Ç–∞–ª–æ–≥–æ–≤
- –û—Ç—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ç–µ–∫—Å—Ç–æ–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** –ß—ë—Ç–∫–∏–π —Ç–µ–∫—Å—Ç, –∫–æ–Ω—Ç—Ä–∞—Å—Ç

#### ‚ö†Ô∏è –°–ª–æ–∂–Ω—ã–µ —Å–ª—É—á–∞–∏:
- –ú–Ω–æ–≥–æ–∫–æ–ª–æ–Ω–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å —Ä—É—á–Ω–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏)
- –†—É–∫–æ–ø–∏—Å–Ω—ã–π —Ç–µ–∫—Å—Ç (–Ω–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å OCR)
- –ù–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–∫–∞–Ω–æ–≤ (–æ—à–∏–±–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è)

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ** | 5 (4 core + 1 UI) |
| **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞** | ~1200 |
| **–ü–∞—Ä—Å–µ—Ä—ã** | 2 (Table + OCR) |
| **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** | Tab-delimited, Space-delimited, Key-Value, OCR |
| **–Ø–∑—ã–∫–∏ OCR** | English, Russian |
| **–°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏** | ‚úÖ BUILD SUCCEEDED |

---

## üéì –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. Strategy Pattern –¥–ª—è –ø–∞—Ä—Å–µ—Ä–æ–≤
- –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –ø–∞—Ä—Å–µ—Ä—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —á–µ—Ä–µ–∑ `canParse()`
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

### 2. Confidence-based —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ö–∞–∂–¥—ã–π `ParsedItem` –∏–º–µ–µ—Ç `confidence: Double`
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–æ—Ä–æ–≥ —á–µ—Ä–µ–∑ `PDFParserConfig`
- OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã √ó 0.8 –∏–∑-–∑–∞ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏

### 3. Vision Framework –¥–ª—è OCR
- –ù–∞—Ç–∏–≤–Ω—ã–π Apple OCR (–±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–≥–∏—Ö —è–∑—ã–∫–æ–≤
- –ê–≤—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏—è —Ç–µ–∫—Å—Ç–∞

### 4. Async/Await –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
- –í–µ—Å—å –ø–∞—Ä—Å–∏–Ω–≥ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 5. Sandbox-safe file access
```swift
url.startAccessingSecurityScopedResource()
defer { url.stopAccessingSecurityScopedResource() }
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. ‚ùå **–ú–Ω–æ–≥–æ–∫–æ–ª–æ–Ω–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã** ‚Äî –º–æ–∂–µ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–∞—Ä—Å–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –º–∞–∫–µ—Ç—ã
2. ‚ùå **–í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äî –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∏–µ—Ä–∞—Ä—Ö–∏–∏
3. ‚ùå **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤** ‚Äî –Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç (—Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç)
4. ‚ö†Ô∏è **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏** ‚Äî –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–µ (–Ω—É–∂–µ–Ω ML –≤ –±—É–¥—É—â–µ–º)
5. ‚ö†Ô∏è **OCR —Ç–æ—á–Ω–æ—Å—Ç—å** ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∫–∞–Ω–∞ (70-95%)
6. ‚ùå **–ë–∞—Ç—á –∏–º–ø–æ—Ä—Ç** ‚Äî —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª –∑–∞ —Ä–∞–∑

---

## üîú –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–µ –≤ —Ç–µ–∫—É—â–µ–º —Å–ø—Ä–∏–Ω—Ç–µ)

1. **AI-based –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è** —á–µ—Ä–µ–∑ OpenAI/Claude API
2. **–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º** —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. **–®–∞–±–ª–æ–Ω—ã –ø–∞—Ä—Å–∏–Ω–≥–∞** –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
4. **–ò–º–ø–æ—Ä—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** –∏–∑ PDF
5. **–û–±—É—á–∞–µ–º—ã–µ –ø–∞—Ä—Å–µ—Ä—ã** (ML-based)
6. **–ë–∞—Ç—á-–∏–º–ø–æ—Ä—Ç** –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
7. **–ò—Å—Ç–æ—Ä–∏—è –∏–º–ø–æ—Ä—Ç–æ–≤** —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–∫–∞—Ç–∞

---

## üîú –°–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç: –ü–æ–∏—Å–∫ (FTS5 + Vector)

### –°–ø—Ä–∏–Ω—Ç 3 (2 –Ω–µ–¥–µ–ª–∏)

**–¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–º–Ω—ã–π –ø–æ–∏—Å–∫

**–ó–∞–¥–∞—á–∏:**
1. **FTS5Search** ‚Äî –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ SQLite
2. **EmbeddingEngine** ‚Äî CoreML –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
3. **VectorStore** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–∏—Å–∫ –≤–µ–∫—Ç–æ—Ä–æ–≤
4. **RAGEngine** ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –ø–æ–∏—Å–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
5. –û–±–Ω–æ–≤–∏—Ç—å **SearchView** —Å –≥–∏–±—Ä–∏–¥–Ω—ã–º –ø–æ–∏—Å–∫–æ–º

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** ‚ö†Ô∏è –°–†–ï–î–ù–Ø–Ø (–∫–∞—á–µ—Å—Ç–≤–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏)

---

## ‚úÖ –ò—Ç–æ–≥–∏ –°–ø—Ä–∏–Ω—Ç–∞ 2

**–°—Ç–∞—Ç—É—Å:** ‚ú® **–£–°–ü–ï–®–ù–û –ó–ê–í–ï–†–®–Å–ù**

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π PDF –∏–º–ø–æ—Ä—Ç:
- ‚úÖ 2 –ø–∞—Ä—Å–µ—Ä–∞ (Table + OCR) —Å Strategy Pattern
- ‚úÖ –ê–≤—Ç–æ–≤—ã–±–æ—Ä –ø–∞—Ä—Å–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–æ—Ä–º–∞—Ç–∞
- ‚úÖ UI —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –æ—Ç—á—ë—Ç–∞–º–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ItemService
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ –≤ OCR
- ‚úÖ –ü—Ä–æ–µ–∫—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 1 —Å–µ—Å—Å–∏—è (05.10.2025)
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:** 35% (CRUD + PDF –∏–º–ø–æ—Ä—Ç)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 05.10.2025
**–°–ª–µ–¥—É—é—â–∏–π —Å–ø—Ä–∏–Ω—Ç:** –ü–æ–∏—Å–∫ (FTS5 + Vector) ‚Äî –°–ø—Ä–∏–Ω—Ç 3
